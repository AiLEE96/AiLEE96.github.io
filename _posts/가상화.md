# 가상화

**가상화** : 물리적인 하드웨어 환경에서 논리적인 객체로 추상화 하는 것. 즉, 가상화를 시켜주는 프로그램을 통해서 물리적 머신 안에(호스트의 리소스를 사용해서) 가상의 머신을 만드는 것을 의미한다.

가상화 대상에 따라 5가지로 구분 할 수 있다.

- **서버 가상화 :** 소프트웨어 애플리케이션을 통해 물리적 서버를 여러 개로 분리된 고유한 가상 서버로 나누는 과정, 각 가상 서버는 자체 운영 체제를 독립적으로 실행할 수 있다.
- **데스크톱 가상화 :** 가상의 데스크탑을 마치 로컬 시스템처럼 활용할 수 있으며, 모든 작업의 프로세싱과 저장은 데이터 센터에 위치한 서버에서 처리됨. VDI 환경에서는 언제 어디서든 네트워크만 연결이 된다면 서버에 접속하여 자신만의 PC 환경을 구동 시킬 수 있음.
- **애플리케이션 가상화 :** 해당 응용 프로그램이 실행되는 운영체제로부터 소프트웨어를 캡슐화시켜서 독립적인 환경에서 애플리케이션을 구동 시킬 수 있다.
- **네트워크 가상화 :**  네트워크 기능 가상화(NFV)는 전용 하드웨어 기반에서 동작하는 네트워크 기능을 범용 x86 서버 기반에서 수행하는 것을 의미, 스위치나 라우터 등의 물리적 네트워크 장비 기능을 가상화하여 가상 머신(VM)이나 컨테이너(Container), 또는 범용 프로세서를 탑재한 하드웨어에서 구동하는 방식 [이해 못했다]
- **스토리지 가상화 :** 스토리지 가상화는 여러개의 디스크를 묶어 하나로 합친 뒤에 LUN을 만들어 외부와 통신할 수 있게 하는 것. 이때 스토리지에 대한 하드웨어 가상화, 소프트웨어 가상화 2가지로 구분할 수 있다. 소프트웨어 방식의 스토리지 가상화 대표는 RAID[0-6] 방식이 존재한다. 이때 각 넘버마다 그 방식이 다르다. [레이드 방식 따로 빼서 작성]

가상화 기술에는 4가지 종류가 있다.

- **호스트 가상화 방식** : 호스트 운영체제 위에 가상화 소프트웨어를 설치, 소프트웨어를 통해서 가상머신(게스트 OS)을 작동 시키는 방식이다. 호스트OS의 문제가 생기면 각 게스트 OS도 영향을 받게 된다.
- **전가상화 방식** : 베어메탈, 하이퍼바이저 가상화라고도 하며 하이퍼바이저라는 소프트웨어를 물리 하드웨어 위에 직접 구동시켜 하이퍼바이저 위에 각각의 하드웨어에 게스트 운영체제를 설치해서 움직이게 한다. 호스트 OS와 다른 점은 가상머신이 마치 독립적인 호스트 시스템처럼 작동한다는 것. 복수의 가상머신이 서로 간섭하지 않도록 하기 때문에 처리 오버헤드가 존재하지 않는다.
    
    하이퍼바이저를 구동하면 모든 가상머신들이 도메인제로(DOM0)에 의해서 접근 및 관리가 이뤄진다. 왜냐하면 하이퍼 바이저위에 운영되는 게스트 OS들은 커널에서 사용되는 규칙이 모두 다르기 때문에 DOM0에 의해서 관리가 이뤄진다.
    
    각 OS들의 요청이 DOM0에 도착하게 되고 DOM0가 이를 번역해서 하이퍼 바이저에게 요청을 전달하는 과정을 거친다. 따라서 게스트 OS의 운영체제가 뭐가 됐던 상관이 없다는 장점이 있지만 반대로 DOM0를 필수적으로 거쳐야 하기 때문에 처리 속도가 느리다는 단점이 있다.
    
- **반가상화 방식** : 전가상화의 큰 문제점인 성능 문제를 해결하기 위해서 하드웨어를 완전히 가상화 하지 않는 기술. 게스트 OS의 커널 일부를 수정, 특권 명령이 수행될 때 Hyper call을 호출, 하이퍼 바이저가 실행되도록 하는 기술로 게스트 OS가 하드웨어를 직접 제어하지 않고 하이퍼 바이저가 제어하는 방식.
    
    전가상화에선 OS 커널에 명령 방식이 달라 DOM0가 번역해서 하드웨어에 전달하는 과정을 거쳤지만 반가상화는 각각의 가상 머신에서 직접 번역을 해서 하이퍼 바이저에게 전달 해주는 방식이다.
    
- **컨테이너 가상화 방식** : OS를 가상화 하는게 아니라 어플리케이션 즉, 소프트웨어를 바로 가상화 하는 방식이다. 각각의 프로세스가 독립된 환경에서 실행되기 때문에 리소스는 프로세스가 필요한 만큼만 사용되며 각 컨테이너는 서로에게 영향을 주지 않기 때문에 가볍다.
    
    이때 주로 이용되는 프로그램을 바로 하이퍼 바이저(Hypervisor)라고 하며 하이퍼 바이저가 설치된 물리 하드웨어를 호스트OS, 호스트의 리소스를 사용해서 생성된 가상의 머신(VM, Virtual Machine)을 게스트OS라고 한다.. 그렇다면 하이퍼 바이저(Hypervisor)란?
    

**하이퍼 바이저** : 가상화 머신 매니저, 가상화 머신 모니터라고 불리는 하이퍼 바이저는 호스트 컴퓨터에서 생성된 가상의 머신을 운영할 수 있는 환경을 제공하는 플랫폼. 하이퍼 바이저 가상화는 2가지 유형으로 구분된다.  각 플랫폼 별로 사용하는 하이퍼 바이저가 다르며 예전에는 CPU마다 적합한 하이퍼 바이저가 존재했다. 또한 바이오스에 접속해서 가상화 기능을 켜 놔야만 사용이 가능하다.

- 베어메탈(전 가상화) : 설치된 OS에 의해서 하드웨어의 리소스를 공유하는 방식이 아니라 하나의 물리적 하드웨어에 직접적으로 설치되어 모든 성능을 사용할 수 있는 방식을 베어메탈이라고 한다. VMware ESX, ESXI / Microsoft Hyper-V / Xen등이 이에 속한다.

- 호스팅(호스팅 가상화) : 다른 응용프로그램과 마찬가지로 설치되어 있는 OS 위에서 하이퍼 바이저가 실행되는 것을 의미한다. 일반적으로 하이퍼 바이저에 의해서 실행 되는 게스트 OS는 호스트에서 프로세스로 실행되는 반면에 하이퍼 바이저는 게스트와 호스트를 분리해 놓는다.